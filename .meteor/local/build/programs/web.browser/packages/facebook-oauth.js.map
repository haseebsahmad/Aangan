{"version":3,"sources":["meteor://ðŸ’»app/packages/facebook-oauth/facebook_client.js"],"names":["Facebook","requestCredential","options","credentialRequestCompleteCallback","config","ServiceConfiguration","configurations","findOne","service","ConfigError","credentialToken","Random","secret","mobile","test","navigator","userAgent","display","scope","requestPermissions","join","loginStyle","OAuth","_loginStyle","API_VERSION","Meteor","settings","public","packages","apiVersion","loginUrl","appId","_redirectUri","params","absoluteUrlOptions","_stateParam","redirectUrl","auth_type","encodeURIComponent","launchLogin","loginService"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAAA,QAAQ,GAAG,EAAX,C,CAEA;AACA;AACA;AACA;AACA;AACA;;AACAA,QAAQ,CAACC,iBAAT,GAA6B,CAACC,OAAD,EAAUC,iCAAV,KAAgD;AAAA;;AAC3E;AACA,MAAI,CAACA,iCAAD,IAAsC,OAAOD,OAAP,KAAmB,UAA7D,EAAyE;AACvEC,qCAAiC,GAAGD,OAApC;AACAA,WAAO,GAAG,EAAV;AACD;;AAED,QAAME,MAAM,GAAGC,oBAAoB,CAACC,cAArB,CAAoCC,OAApC,CAA4C;AAACC,WAAO,EAAE;AAAV,GAA5C,CAAf;;AACA,MAAI,CAACJ,MAAL,EAAa;AACXD,qCAAiC,IAAIA,iCAAiC,CACpE,IAAIE,oBAAoB,CAACI,WAAzB,EADoE,CAAtE;AAEA;AACD;;AAED,QAAMC,eAAe,GAAGC,MAAM,CAACC,MAAP,EAAxB;AACA,QAAMC,MAAM,GAAG,2DAA2DC,IAA3D,CAAgEC,SAAS,CAACC,SAA1E,CAAf;AACA,QAAMC,OAAO,GAAGJ,MAAM,GAAG,OAAH,GAAa,OAAnC;AAEA,MAAIK,KAAK,GAAG,OAAZ;AACA,MAAIhB,OAAO,IAAIA,OAAO,CAACiB,kBAAvB,EACED,KAAK,GAAGhB,OAAO,CAACiB,kBAAR,CAA2BC,IAA3B,CAAgC,GAAhC,CAAR;;AAEF,QAAMC,UAAU,GAAGC,KAAK,CAACC,WAAN,CAAkB,UAAlB,EAA8BnB,MAA9B,EAAsCF,OAAtC,CAAnB;;AAEA,QAAMsB,WAAW,GAAG,qBAAAC,MAAM,CAACC,QAAP,+FAAiBC,MAAjB,0GAAyBC,QAAzB,4GAAoC,gBAApC,mFAAuDC,UAAvD,KAAqE,MAAzF;AAEA,MAAIC,QAAQ,GACR,oCAA6BN,WAA7B,qCAAmEpB,MAAM,CAAC2B,KAA1E,4BACiBT,KAAK,CAACU,YAAN,CAAmB,UAAnB,EAA+B5B,MAA/B,EAAuCF,OAAO,CAAC+B,MAA/C,EAAuD/B,OAAO,CAACgC,kBAA/D,CADjB,uBAEYjB,OAFZ,oBAE6BC,KAF7B,qBAGUI,KAAK,CAACa,WAAN,CAAkBd,UAAlB,EAA8BX,eAA9B,EAA+CR,OAAO,IAAIA,OAAO,CAACkC,WAAlE,CAHV,CADJ,CA1B2E,CAgC3E;;AACA,MAAIlC,OAAO,IAAIA,OAAO,CAACmC,SAAvB,EAAkC;AAChCP,YAAQ,yBAAkBQ,kBAAkB,CAACpC,OAAO,CAACmC,SAAT,CAApC,CAAR;AACD;;AAEDf,OAAK,CAACiB,WAAN,CAAkB;AAChBC,gBAAY,EAAE,UADE;AAEhBnB,cAFgB;AAGhBS,YAHgB;AAIhB3B,qCAJgB;AAKhBO;AALgB,GAAlB;AAOD,CA5CD,C","file":"/packages/facebook-oauth.js","sourcesContent":["Facebook = {};\n\n// Request Facebook credentials for the user\n//\n// @param options {optional}\n// @param credentialRequestCompleteCallback {Function} Callback function to call on\n//   completion. Takes one argument, credentialToken on success, or Error on\n//   error.\nFacebook.requestCredential = (options, credentialRequestCompleteCallback) => {\n  // support both (options, callback) and (callback).\n  if (!credentialRequestCompleteCallback && typeof options === 'function') {\n    credentialRequestCompleteCallback = options;\n    options = {};\n  }\n\n  const config = ServiceConfiguration.configurations.findOne({service: 'facebook'});\n  if (!config) {\n    credentialRequestCompleteCallback && credentialRequestCompleteCallback(\n      new ServiceConfiguration.ConfigError());\n    return;\n  }\n\n  const credentialToken = Random.secret();\n  const mobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i.test(navigator.userAgent);\n  const display = mobile ? 'touch' : 'popup';\n\n  let scope = \"email\";\n  if (options && options.requestPermissions)\n    scope = options.requestPermissions.join(',');\n\n  const loginStyle = OAuth._loginStyle('facebook', config, options);\n\n  const API_VERSION = Meteor.settings?.public?.packages?.['facebook-oauth']?.apiVersion || '10.0';\n\n  let loginUrl =\n      `https://www.facebook.com/v${API_VERSION}/dialog/oauth?client_id=${config.appId}` +\n      `&redirect_uri=${OAuth._redirectUri('facebook', config, options.params, options.absoluteUrlOptions)}` +\n      `&display=${display}&scope=${scope}` +\n      `&state=${OAuth._stateParam(loginStyle, credentialToken, options && options.redirectUrl)}`;\n\n  // Handle authentication type (e.g. for force login you need auth_type: \"reauthenticate\")\n  if (options && options.auth_type) {\n    loginUrl += `&auth_type=${encodeURIComponent(options.auth_type)}`;\n  }\n\n  OAuth.launchLogin({\n    loginService: \"facebook\",\n    loginStyle,\n    loginUrl,\n    credentialRequestCompleteCallback,\n    credentialToken,\n  });\n};\n"]}